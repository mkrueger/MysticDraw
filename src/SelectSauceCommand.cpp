#include<SelectSauceCommand.hpp>

unsigned char SauceAnsi[4096] = {
32,7,32,7,32,7,0,7,0,7,0,7,0,7,0,7,0,7,223,8,32,
8,223,8,32,8,223,8,32,8,32,8,32,8,223,8,223,8,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,223,
8,32,8,32,8,32,8,223,8,32,8,223,8,32,8,223,8,0,7,0,
7,0,7,0,7,0,7,32,8,32,8,32,8,32,8,32,8,32,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,223,3,32,3,219,8,219,8,32,8,32,8,219,8,219,8,32,8,32,
56,32,56,176,50,32,50,223,3,32,51,32,51,0,7,32,51,176,50,32,
50,32,50,223,3,32,51,32,51,0,7,32,51,32,51,32,51,32,51,0,
7,32,51,32,51,0,7,32,51,176,50,32,50,32,50,223,3,32,51,32,
51,0,7,32,51,176,50,32,50,32,50,223,3,32,51,32,51,0,7,219,
8,32,8,32,8,219,8,219,8,32,8,223,3,32,3,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,176,50,0,7,219,8,219,8,32,8,32,8,219,8,219,8,32,8,176,
50,176,50,176,50,176,50,0,7,0,7,0,7,0,7,176,50,176,50,176,
50,176,50,0,7,176,50,176,50,0,7,176,50,176,50,176,50,176,50,0,
7,176,50,176,50,0,7,176,50,176,50,176,50,176,50,0,7,0,7,0,
7,0,7,176,50,176,50,176,50,176,50,0,7,0,7,0,7,220,8,219,
8,32,8,32,8,219,8,219,8,32,8,176,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,220,8,220,8,219,8,219,8,32,
8,177,50,0,7,219,8,219,8,220,8,220,8,219,8,219,8,32,8,223,
3,223,3,223,3,223,3,223,3,177,50,177,50,222,8,177,50,177,50,177,
50,177,50,223,3,177,50,177,50,222,8,177,50,177,50,177,50,177,50,222,
8,177,50,177,50,222,8,177,50,177,50,177,50,177,50,0,7,0,7,0,
7,222,8,177,50,177,50,177,50,177,50,223,3,32,3,32,3,219,8,219,
8,220,8,220,8,219,8,219,8,32,8,177,50,0,7,219,8,219,8,220,
8,220,8,220,8,220,8,220,8,0,7,0,7,0,7,0,7,0,8,32,
8,32,8,223,8,32,8,223,8,223,8,223,8,223,8,223,8,223,8,32,
8,178,50,0,7,223,8,223,8,223,8,223,8,223,8,32,8,222,8,219,
50,178,50,219,50,178,50,0,7,219,50,178,50,222,8,219,50,178,50,219,
50,178,50,222,8,219,50,178,50,222,8,178,50,219,50,178,50,219,50,222,
8,178,50,219,50,222,8,178,50,219,50,219,50,178,50,0,7,0,7,0,
7,222,8,219,50,178,50,219,50,178,50,0,7,0,7,0,7,223,8,223,
8,223,8,223,8,223,8,223,8,32,8,178,50,0,7,223,8,223,8,223,
8,223,8,223,8,223,8,223,8,223,8,223,8,32,8,223,8,0,8,32,
8,223,8,32,8,32,8,223,2,32,2,223,2,223,2,223,2,223,2,223,
2,219,50,223,2,223,2,223,2,223,2,223,2,223,2,223,2,222,8,219,
50,219,50,219,50,219,50,219,50,219,50,219,50,222,8,219,50,219,50,219,
50,219,50,222,8,219,50,219,50,222,8,219,50,219,50,219,50,219,50,220,
2,219,50,219,50,222,8,219,50,219,50,219,50,219,50,220,2,219,50,219,
50,222,8,219,50,219,50,219,50,219,50,220,2,219,50,219,50,0,7,223,
2,223,2,223,2,223,2,223,2,223,2,219,50,223,2,223,2,223,2,223,
2,223,2,223,2,223,2,223,2,32,2,223,2,32,2,32,2,223,8,32,
8,223,8,32,8,223,8,223,8,223,8,219,8,219,8,219,8,219,8,32,
8,178,50,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,
15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,
15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,
15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,
15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,15,32,
15,32,15,32,15,32,15,32,15,0,7,178,50,0,7,219,8,219,8,219,
8,219,8,219,8,219,8,219,8,223,8,223,8,223,8,32,8,223,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,178,50,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,178,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,177,50,0,7,0,7,32,15,83,15,65,7,86,8,69,8,32,8,83,
15,65,7,85,8,67,8,69,8,32,8,105,15,78,7,70,8,79,8,82,
8,77,8,65,8,84,8,105,15,79,8,78,8,58,8,32,8,91,8,32,
15,93,8,32,8,89,15,69,7,80,8,32,8,32,8,91,8,32,15,93,
8,32,8,78,15,79,7,80,8,69,8,0,7,0,7,0,7,32,8,32,
8,32,8,32,8,0,7,0,7,0,7,177,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,177,50,0,7,0,7,0,7,32,15,32,15,32,15,32,15,32,15,32,
15,32,15,32,15,32,15,32,15,32,15,32,15,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,177,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,177,50,0,7,0,7,32,7,65,15,78,7,83,8,105,8,45,8,84,
15,105,7,84,8,76,8,69,8,32,8,0,7,91,8,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,
7,250,7,250,7,93,8,32,7,0,7,177,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,176,50,0,7,0,7,32,7,65,15,82,7,84,8,105,8,83,8,84,
8,45,8,78,15,65,7,77,8,69,8,32,8,91,8,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,93,8,32,7,32,
7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,0,
7,0,7,32,8,0,7,32,7,0,7,176,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,32,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,176,50,0,7,0,7,32,7,71,15,82,7,79,8,85,8,80,8,32,
8,32,8,32,8,32,8,32,8,32,8,32,8,91,8,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,250,
7,250,7,250,7,250,7,250,7,250,7,250,7,250,7,93,8,32,7,32,
7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,
8,32,8,32,8,0,7,32,7,0,7,176,50,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,32,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,32,56,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,32,
7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,
7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,
7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,7,32,
7,0,7,0,7,0,7,0,7,0,7,32,56,0,7,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,220,8,220,8,219,8,219,8,32,
8,32,56,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,32,56,0,7,219,8,219,8,220,
8,220,8,220,8,220,8,220,8,220,8,0,7,0,7,0,7,0,8,32,
8,223,8,32,8,223,8,223,8,223,8,223,8,223,8,223,8,223,8,32,
8,32,56,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,176,50,32,50,176,50,32,50,0,7,0,7,0,7,32,50,176,
50,32,50,32,50,223,3,32,51,32,51,0,7,0,7,0,7,32,51,32,
51,176,50,32,50,223,3,32,51,32,51,0,7,0,7,0,7,176,50,32,
50,32,50,32,50,223,3,32,51,32,51,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,32,51,0,7,223,8,223,8,223,
8,223,8,223,8,223,8,223,8,223,8,223,8,223,8,32,8,223,8,223,
8,32,8,223,3,32,3,223,3,223,3,223,3,223,3,223,3,223,3,223,
3,32,51,223,3,223,3,223,3,223,3,223,3,223,3,223,3,223,3,223,
3,32,3,176,50,176,50,176,50,176,50,0,7,223,3,32,3,176,50,176,
50,176,50,176,50,0,7,176,50,176,50,0,7,223,3,32,3,176,50,176,
50,176,50,176,50,0,7,0,7,0,7,0,7,223,3,32,3,176,50,176,
50,176,50,176,50,0,7,176,50,176,50,0,7,223,3,223,3,223,3,223,
3,223,3,223,3,223,3,223,3,223,3,32,51,223,3,223,3,223,3,223,
3,223,3,223,3,223,3,223,3,223,3,223,3,32,3,223,3,0,8,32,
3,223,8,32,8,223,8,223,8,223,8,223,8,223,8,219,8,219,8,32,
8,177,50,0,7,219,8,223,8,32,8,223,8,32,8,223,8,223,8,221,
8,222,8,177,50,177,50,177,50,177,50,0,7,0,7,222,8,177,50,177,
50,177,50,177,50,222,8,177,50,177,50,0,7,0,7,222,8,177,50,177,
50,177,50,177,50,223,3,32,3,32,3,32,3,32,3,222,8,177,50,177,
50,177,50,177,50,222,8,177,50,177,50,0,7,219,8,223,8,223,8,32,
8,223,8,32,8,223,8,219,8,32,8,177,50,0,7,219,8,223,8,223,
8,223,8,223,8,223,8,223,8,223,8,223,8,223,8,32,8,223,8,0,
7,0,7,0,7,0,7,0,7,223,8,32,8,223,8,223,8,223,8,32,
8,178,50,0,7,223,8,223,8,223,8,32,8,223,8,32,8,223,8,32,
8,222,8,219,50,178,50,219,50,178,50,0,7,0,7,222,8,178,50,219,
50,178,50,178,50,222,8,178,50,178,50,0,7,0,7,222,8,219,50,178,
50,219,50,178,50,0,7,0,7,0,7,0,7,0,7,222,8,178,50,219,
50,178,50,219,50,222,8,219,50,178,50,0,7,223,8,223,8,32,8,223,
8,223,8,32,8,223,8,223,8,32,8,178,50,0,7,223,8,223,8,32,
8,223,8,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,223,2,223,2,223,
2,219,50,223,2,223,2,223,2,223,2,223,2,223,2,223,2,223,2,223,
2,222,8,219,50,219,50,219,50,219,50,0,7,223,2,222,8,219,50,219,
50,219,50,219,50,222,8,219,50,219,50,0,7,223,2,222,8,219,50,219,
50,219,50,219,50,0,7,223,2,223,2,223,2,223,2,222,8,219,50,219,
50,219,50,219,50,220,2,219,50,219,50,0,7,223,2,223,2,223,2,223,
2,223,2,223,2,223,2,223,2,223,2,219,50,223,2,223,2,223,2,32,
2,223,8,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,223,8,32,8,223,8,219,8,219,8,32,
8,220,2,32,2,219,8,219,8,219,8,219,8,219,8,219,8,219,8,219,
8,220,8,220,8,220,8,220,8,220,8,220,8,219,8,220,8,220,8,220,
8,220,8,220,8,220,8,220,8,220,8,220,8,219,8,220,8,220,8,220,
8,220,8,220,8,220,8,219,8,219,8,219,8,219,8,220,8,220,8,220,
8,220,8,220,8,220,8,220,8,220,8,220,8,219,8,219,8,219,8,219,
8,219,8,219,8,219,8,219,8,32,8,220,2,32,2,219,8,219,8,223,
8,223,8,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,219,8,219,8,32,
8,254,2,32,2,219,8,219,8,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,219,8,219,8,32,8,254,2,32,2,219,8,219,8,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,220,8,32,
8,220,8,32,8,220,8,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,220,8,32,8,220,8,32,8,220,8,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,7,0,
0,0,0,0,0,0,0,0,0,186,176,25,142,218,140,6,56,0,51,237,
232,121,9,232,160,0,139,196,5,19,0,177,4,211,232,140,210,3,194,163,
10,0,163,12,0,3,6,4,0,163,14,0,163,24,0,163,28,0,163,36,
0,142,6,56,0,38,161,2,0,163,32,0,199,6,42,0,214,0,140,14,
44,0,191,84,3,190,57,2,185,19,0,144,252,46,172};

void SelectSauceCommand::run()
{
	char *nul;
	int  a=0;
	unsigned int b;
	ansout << gotoxy(0, 0);
	for (int x = 0;x < 2000; ++x) {
		if (SauceAnsi[x<<1]==0) {
			SauceAnsi[x<<1]=32;
		}
		ansout << textattr(SauceAnsi[(x<<1)+1]) << SauceAnsi[x<<1];
		if (COLS>80&&(x+1)%80==0) {
			ansout << endl;
		}
	}
	
	Sauce* sauce = &MysticDrawMain::getInstance().getCurrentBuffer()->getSauce();
	
	bool done = false;
	SDL_Event event;
	do {
		ansout << textattr(15) << gotoxy(28, 10) << sauce->Title;
		ansout << textattr(7);
		for (b=strlen((const char*)sauce->Title);b<35;b++) {
			ansout << (char)250;
		}
		
		ansout << gotoxy(28, 11) << textattr(15) << sauce->Author;
		ansout << textattr(7);
		for (b=strlen((const char*)sauce->Author);b<20;b++) ansout << (char)250;
		ansout << gotoxy(28, 12) << textattr(15) << sauce->Group;
		ansout << textattr(7);
		for (b=strlen((const char*)sauce->Group);b<20;b++) ansout << (char)250;
		ansout << gotoxy(40, 8) << textattr(15);
		if (MysticDrawMain::getInstance().getCurrentBuffer()->doSaveSauce()) {
			ansout << 'x';
		} else {
			ansout << ' ';
		}
		ansout << gotoxy(49, 8);
		if (MysticDrawMain::getInstance().getCurrentBuffer()->doSaveSauce()) {
			ansout << ' '; 
		} else {
			ansout << 'x';
		}
		ansout << gotoxy(14, 8) << ' ';
		ansout << gotoxy(14, 10) << ' ';
		ansout << gotoxy(14, 11) << ' ';
		ansout << gotoxy(14, 12) << ' ';
		ansout << textattr(14) << gotoxy(14, 8+a+(a>0)) << '>'; 
		screenEngine.showScreen();
		SDL_Delay(50);
		while (SDL_PollEvent(&event)) {
			switch (event.type) {
				case SDL_KEYDOWN:
					switch (event.key.keysym.sym) {
						case SDLK_ESCAPE:
							done = true;
							break;
						case SDLK_RETURN:
							switch(a) {
								case 0:
									MysticDrawMain::getInstance().getCurrentBuffer()->doSaveSauce() = !MysticDrawMain::getInstance().getCurrentBuffer()->doSaveSauce();
									break;
								case 1:
									nul = inputfield((char*)sauce->Title,35,28,10);
									for (b=0;b<=strlen(nul);b++) {
										sauce->Title[b]=nul[b];
									}
									break;
								case 2:
									nul=inputfield((char*)sauce->Author,20,28,11);
									for (b=0;b<=strlen(nul);b++) sauce->Author[b]=nul[b];
									break;
								case 3:
									nul=inputfield((char*)sauce->Group,20,28,12);
									for (b=0;b<=strlen(nul);b++) sauce->Group[b]=nul[b];
									break;
							}
							break;
						case SDLK_UP:
							if (a>0) a--; else a=3;
							break;
						case SDLK_DOWN:
							if (a<3) a++; else a=0;
							break;
						default:
							break;
					}
			}
		}
	} while (!done);
}
